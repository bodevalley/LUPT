Download GitHub Repo:
sudo git clone https://github.com/bodevalley/LUPT.git

Update System:
sudo apt upgrade

Check for alias:
alias

Remove all aliases:
unalias -a or unalias $ALIASNAME

Check for users: 
cat /etc/passwd
Remove any unnecessary users

Add your user to sudo groups:
usermod -aG wheel $USERNAME  #centos
usermod -aG sudo $USERNAME   #debian/ubuntu

Change Root Login Shell:
nano /etc/passwd
	• Change /bin/bash to /sbin/nologin for root

Disable Root Login Via Console Device
	• mv /etc/securetty /etc/securetty.orig
	• touch /etc/securetty
	• chmod 600 /etc/securetty
	
Disable SSH Root Login
	• vim /etc/ssh/sshd_config
	• PermitRootLogin no
	• Restart ssh

Change password:
passwd $USERNAME

Lock boot directory: 
nano /etc/fstab
	• 
chown root:root /etc/fstab

Boot Permissions:
chown root:root /etc/grub.conf
chmod 400 /etc/grub.conf
sed -i "/SINGLE/s/sushell/sulogin/" /etc/sysconfig/init 
sed -i "/PROMPT/s/yes/no/" /etc/sysconfig/init

Check installed packages:
apt-cache pkgnames
yum list installed

Check open ports:
netstat -antp

Secure SSH:
nano /etc/ssh/sshd_config
	• PermitRootLogin no
	• PermitEmptyPasswords no
chown root:root /etc/ssh/sshd_config
chmod 600 /etc/ssh/sshd_config

Enable SELinux:
nano /etc/selinux/config
	• SELINUX=enforcing

Single User Mode Password:
grub2-setpassword

#Find menuentry and remove --unrestricted
vim /boot/grub2/grub.cfg 
#Reboot to verify password is set

Run Sparky Scripts using sparky.sh -m:
	chattrOn.sh for turning on chattr for sensitive files
	log_cmd.sh for logging commands run, stored in /var/log/cmd.log
	scan.sh to scan for suspicious file names
	permissions.sh to harden certain file permissions
	ufwEnable.sh to turn on the firewall, run with ports 20 and 21 and enable ssh
	backupCron.sh to backup specific files and create cron jobs for them
	addPersistence.sh to create new users for persistence, must set the passwords and add to the excel sheet

Vulnerability Enumeration:
Follow lynus and rkhunter tutorials on github
